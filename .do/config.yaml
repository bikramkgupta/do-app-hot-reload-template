#
# Hot Reload Dev Environment Configuration
#
# This file stores your deployment settings. Edit once, deploy many times.
# The GitHub Actions workflow reads this file to generate the app spec.
#
# Usage:
#   1. Copy this file to your repository's .do/config.yaml
#   2. Edit the values below
#   3. Run: gh workflow run deploy-app.yml -f action=deploy
#
# For advanced users: Set app_spec_path to use your own app spec instead.
#

# === App Settings ===
app_name: hot-reload-dev
region: syd1  # nyc1, nyc3, ams3, sfo3, sgp1, lon1, fra1, tor1, blr1, syd1

# Runtime image - determines which languages are available
# Options: node, bun, python, go, ruby, node-python, full
runtime: node

# Instance size - see https://docs.digitalocean.com/products/app-platform/details/pricing/
# Shared CPU (dev/testing):
#   apps-s-1vcpu-0.5gb, apps-s-1vcpu-1gb, apps-s-1vcpu-2gb, apps-s-2vcpu-4gb
# Dedicated CPU (production-like):
#   apps-d-1vcpu-0.5gb through apps-d-8vcpu-32gb
instance_size: apps-s-1vcpu-2gb

# === Repository Settings ===
# Leave branch empty to use the repository's default branch
branch: ""

# For monorepos: specify the subfolder containing your app (e.g., "apps/web")
repo_folder: ""

# === Sync Settings ===
# How often to sync code from GitHub (seconds)
sync_interval: 15

# === Startup Command ===
# Your repository should contain a dev_startup.sh script.
# See examples/ in this template for reference scripts.
dev_start_command: bash dev_startup.sh

# === Deploy Jobs ===
# Commands that run when code changes are detected (on git commit change)

# Pre-deploy: runs BEFORE app starts (must succeed or deployment fails)
# Example: npm run db:migrate
pre_deploy_command: ""
pre_deploy_timeout: 300

# Post-deploy: runs AFTER app starts (failure is logged but app continues)
# Example: npm run db:seed
post_deploy_command: ""
post_deploy_timeout: 300

# === Environment Variables (type: GENERAL) ===
# Plain-text environment variables. Values can be specified here directly
# or pulled from GitHub Variables (not Secrets).
#
# Scope options:
#   RUN_TIME (default) - Available only at run-time
#   BUILD_TIME         - Available only at build-time
#   RUN_AND_BUILD_TIME - Available at both build and run-time
#
# Format options:
#   Simple:   KEY: value                    (defaults to RUN_TIME)
#   Extended: KEY: { value: "val", scope: BUILD_TIME }
#
envs:
  # Simple format (scope defaults to RUN_TIME):
  # NODE_ENV: development
  # LOG_LEVEL: debug
  #
  # Extended format with scope:
  # NPM_CONFIG_LEGACY_PEER_DEPS:
  #   value: "true"
  #   scope: BUILD_TIME
  # PUBLIC_API_URL:
  #   value: "https://api.example.com"
  #   scope: RUN_AND_BUILD_TIME

# === Secrets (type: SECRET) ===
# Encrypted environment variables. Values are pulled from GitHub Secrets.
# List only the SECRET NAMES here - actual values come from GitHub Secrets.
#
# Scope options:
#   RUN_TIME (default) - Available only at run-time
#   BUILD_TIME         - Available only at build-time
#   RUN_AND_BUILD_TIME - Available at both build and run-time
#
# Format options:
#   Simple:   - SECRET_NAME                 (defaults to RUN_TIME)
#   Extended: - { name: SECRET_NAME, scope: BUILD_TIME }
#
# To add a secret:
#   1. Go to GitHub repo → Settings → Secrets and variables → Actions
#   2. Add a secret (e.g., DATABASE_URL)
#   3. Add the name to this list
#
secrets:
  # Simple format (scope defaults to RUN_TIME):
  # - DATABASE_URL
  # - REDIS_URL
  # - AUTH_SECRET
  #
  # Extended format with scope:
  # - name: NPM_TOKEN
  #   scope: BUILD_TIME
  # - name: SENTRY_AUTH_TOKEN
  #   scope: RUN_AND_BUILD_TIME

# === Advanced: Custom App Spec ===
# For complex deployments (VPC, custom domains, multiple services, etc.),
# you can provide your own app spec instead of having the workflow generate one.
#
# Set this to your app spec path (relative to repo root):
#   app_spec_path: .do/my-custom-app.yaml
#
# When set, the workflow will:
#   - Use your spec directly (no generation)
#   - Still substitute ${VAR} placeholders from GitHub Secrets
#   - Skip all the settings above (they're in your spec)
#
# app_spec_path: ""
